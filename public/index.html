<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#0ea5e9" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="description" content="Go Travel · 说走就走的旅行计划助手——PWA，可安装到桌面，全球加速，品牌化前端。" />
  <meta property="og:title" content="Go Travel · 旅行计划助手" />
  <meta property="og:description" content="输入目的地和天数，生成可复制的行程单与预算建议。" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="/icons/og-512.png" />
  <link rel="canonical" href="/" />

  <title>Go Travel · 带你说走就走</title>
  <link rel="manifest" href="/manifest.json" />
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon-180.png" />

  <style>
    :root{--brand:#0ea5e9;--ink:#0f172a;--muted:#64748b;--bg:#f8fafc;--card:#fff}
    *{box-sizing:border-box}
    html,body{margin:0;padding:0}
    body{font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto;background:var(--bg);color:var(--ink)}
    .wrap{max-width:980px;margin:24px auto;padding:0 16px}
    .hero{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 16px;background:#e0f2fe;border:1px solid #bae6fd;border-radius:16px}
    .brand{display:flex;align-items:center;gap:10px}
    .logo{width:28px;height:28px;border-radius:8px;background:var(--brand);display:inline-block}
    .title{font-weight:800;color:#075985}
    .tag{font-size:12px;color:#0ea5e9;background:#e0f2fe;border:1px solid #bae6fd;border-radius:999px;padding:4px 8px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .card{background:var(--card);border:1px solid #e2e8f0;border-radius:16px;padding:16px;box-shadow:0 6px 18px rgba(0,0,0,.05)}
    label{font-size:12px;color:var(--muted);display:block;margin-bottom:6px}
    input,textarea{width:100%;padding:10px 12px;border:1px solid #cbd5e1;border-radius:12px;background:#fff}
    textarea{min-height:92px;resize:vertical}
    .actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .btn{background:var(--brand);color:#fff;border:0;border-radius:12px;padding:12px 16px;font-weight:700;cursor:pointer}
    .btn:disabled{opacity:.6;cursor:not-allowed}
    .muted{color:var(--muted);font-size:12px}
    .result{min-height:160px;border:1px dashed #cbd5e1;border-radius:12px;padding:12px;background:#fff;white-space:pre-wrap;word-wrap:break-word}
    .footer{margin:18px 0;color:#94a3b8;font-size:12px;text-align:center}

    #installBtn{position:fixed;right:16px;bottom:16px;z-index:9999;padding:10px 14px;border:0;border-radius:12px;background:#0ea5e9;color:#fff;font-weight:700;box-shadow:0 4px 10px rgba(0,0,0,.15);}
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.4);z-index:10000}
    .modal.show{display:flex}
    .dialog{background:#fff;border-radius:14px;max-width:520px;width:90%;padding:18px;box-shadow:0 20px 60px rgba(0,0,0,.2)}
    .dialog h3{margin:0 0 8px}
    .dialog p{margin:0 0 10px;color:#475569}
    .dialog ul{margin:6px 0 0 18px;color:#475569}
    .close{margin-top:10px;background:#e2e8f0;color:#0f172a;border:0;border-radius:10px;padding:8px 12px;font-weight:700;cursor:pointer}

    @media (max-width:860px){ .grid{ grid-template-columns:1fr; } }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="hero">
      <div class="brand">
        <span class="logo"></span>
        <div class="title">Go Travel · 带你说走就走</div>
      </div>
      <span class="tag">PWA • SEO • Edge 加速</span>
    </div>

    <div class="grid" style="margin-top:14px">
      <div class="card">
        <div class="grid">
          <div>
            <label>目的地/城市</label>
            <input id="dest" placeholder="例：伦敦、牛津、约克" />
          </div>
          <div>
            <label>出行天数</label>
            <input id="days" type="number" min="1" max="60" value="5" />
          </div>
        </div>
        <div class="grid" style="margin-top:10px">
          <div>
            <label>人均预算</label>
            <input id="budget" placeholder="例：£500 / ¥3000 / $800" />
          </div>
          <div>
            <label>偏好</label>
            <input id="prefs" placeholder="美食, 自然, 博物馆" />
          </div>
        </div>
        <div style="margin-top:10px">
          <label>额外要求（可选）</label>
          <textarea id="notes" placeholder="例：少走路；适合带狗；公共交通优先；避开过热点位"></textarea>
        </div>
        <div class="grid" style="margin-top:10px">
          <div>
            <label>模型</label>
            <input id="model" value="gpt-4o-mini" />
          </div>
          <div>
            <label>温度（0-1）</label>
            <input id="temp" type="number" min="0" max="1" step="0.1" value="0.7" />
          </div>
        </div>

        <div class="actions">
          <button class="btn" id="genBtn">✨ 生成行程</button>
          <button class="btn" id="regenBtn" disabled>重新生成</button>
          <button class="btn" id="copyBtn" disabled>复制</button>
          <button class="btn" id="dlBtn" disabled>下载 Markdown</button>
        </div>
        <div class="muted" id="status" style="margin-top:6px"></div>
      </div>

      <div class="card">
        <label class="muted">生成结果</label>
        <div id="result" class="result"><span class="muted">生成后显示在这里…</span></div>
      </div>
    </div>

    <div class="footer">© Go Travel. Built for speed on Vercel. 安装到桌面享受全屏体验。</div>
  </div>

  <button id="installBtn" title="安装到桌面">安装 Go Travel</button>

  <div class="modal" id="guide">
    <div class="dialog">
      <h3>如何安装为 App</h3>
      <div id="guideText"></div>
      <button class="close" id="closeGuide">知道了</button>
    </div>
  </div>

  <script src="/app.js?v=1"></script>

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js?v=1').catch(console.error);
      });
    }

    // PWA 安装处理
    let deferredPrompt = null;
    const installBtn = document.getElementById('installBtn');
    const guide = document.getElementById('guide');
    const guideText = document.getElementById('guideText');
    const closeGuide = document.getElementById('closeGuide');

    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
    });

    installBtn.addEventListener('click', async () => {
      const isIOS = /iphone|ipad|ipod/i.test(navigator.userAgent);
      if (deferredPrompt && !isIOS) {
        deferredPrompt.prompt();
        await deferredPrompt.userChoice;
        deferredPrompt = null;
        return;
      }
      showGuide();
    });

    closeGuide.addEventListener('click', () => guide.classList.remove('show'));

    function showGuide() {
      const ua = navigator.userAgent.toLowerCase();
      const isIOS = /iphone|ipad|ipod/.test(ua);
      const isAndroid = /android/.test(ua);
      const isEdge = /edg\//.test(ua);
      const isChrome = /chrome/.test(ua) && !isEdge;

      let html = '';
      if (isIOS) {
        html = '<p>iPhone / iPad（Safari）：</p><ul><li>点底部<b>分享</b>（方框+箭头）</li><li>选择<b>添加到主屏幕</b></li><li>确认名称后<b>添加</b></li></ul>';
      } else if (isAndroid) {
        html = '<p>Android（Chrome）：</p><ul><li>点右上角<b>⋮</b></li><li>选择<b>添加到主屏幕</b>或<b>安装应用</b></li></ul>';
      } else if (isEdge) {
        html = '<p>Edge 桌面：</p><ul><li>右上角<b>⋯</b> → <b>应用</b> → <b>安装此站点为应用</b></li></ul>';
      } else if (isChrome) {
        html = '<p>Chrome 桌面：</p><ul><li>地址栏右侧<b>安装</b>图标或菜单<b>安装</b></li></ul>';
      } else {
        html = '<p>通用指引：</p><ul><li>在浏览器菜单寻找<b>安装</b> / <b>添加到主屏幕</b></li></ul>';
      }
      guideText.innerHTML = html;
      guide.classList.add('show');
    }
  </script>
</body>
</html>
